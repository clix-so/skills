# Repository Guidelines

This file provides guidance to coding assistants when working with code in this repository.

## Project Overview

This is the **Clix Agent Skills** repository - a collection of AI agent skills for Clix mobile SDK integration. Skills follow the [open agent skills standard](https://agentskills.io/home) and can be installed into various AI coding assistants (Claude Code, Cursor, Codex, etc.).

## Commands

```bash
# Install dependencies
npm install

# Build TypeScript
npm run build

# Run tests
npm test

# Run a specific test file
npx jest tests/<test-file>.test.ts

# Lint (Prettier)
npm run lint
npm run lint:fix

# Generate llms.txt (skill index for LLMs)
npm run generate-llms

# Sync version across package.json, marketplace.json, and SKILL.md files
npm run sync-version

# CLI usage (dev mode)
npm run dev -- install <skill-name> --client <client>

# CLI usage (built)
npm start -- install <skill-name> --client <client>
```

## Architecture

### Skill Structure

Each skill in `skills/<skill-name>/` follows this structure:

- `SKILL.md` - Main skill doc with YAML frontmatter (name, description, user-invocable)
- `LICENSE.txt` - License file
- `references/` - Supporting markdown docs (at least 1 file)
- `scripts/` - Deterministic bash validators (at least 1 file)
- `examples/` - Optional code examples
- `rules/` - Optional rule files (used by push-notification-best-practices)

### CLI (`src/bin/`)

The CLI installs skills to different AI client locations:

- `cli.ts` - Entry point with Commander.js
- `commands/install.ts` - Skill installation logic with client-specific paths
- `utils/mcp.ts` - MCP server configuration helper

### Adding a New Skill

When adding a new skill, follow these steps:

1. **Create skill folder** - `skills/<skill-name>/` with required structure (SKILL.md, references/, scripts/, LICENSE.txt)

2. **Update `.claude-plugin/marketplace.json`** (manual) - Add plugin entry:

   ```json
   {
     "name": "<skill-name>",
     "description": "<description for AI to know when to use>",
     "source": "./",
     "strict": false,
     "skills": ["./skills/<skill-name>"]
   }
   ```

3. **Generate `llms.txt`** (automatic) - Run `npm run generate-llms` or push to main (GitHub Actions creates PR)

4. **Update `README.md`** - Add skill to "Available Skills" section if public-facing

**Automation:**

- `llms.txt`: Auto-generated by `scripts/generate-llms.ts` and GitHub Actions (`.github/workflows/generate-llms.yml`)
- `marketplace.json`: Manual update required (no automation)

### Scripts (`scripts/`)

- `generate-llms.ts` - Scans `skills/` and generates `llms.txt` index (supports `references/`, `examples/`, `scripts/`, `rules/` directories)
- `sync-version.ts` - Syncs version from package.json to marketplace.json and SKILL.md frontmatter
- `auto-version.ts` - Auto-versioning helper

## Skill Conventions

Skills use **MCP-first** pattern: when Clix MCP tools are available, treat them as source of truth for SDK signatures and behavior.

SKILL.md frontmatter format:

```yaml
---
name: clix-<kebab-case>
display-name: <Title Case>
short-description: <short>
description: <2-3 lines>
user-invocable: true
---
```

## Testing

Tests are in `tests/` and use Jest. Most tests validate skill scripts and scaffolds:

- `validate-*.test.ts` - Test bash validation scripts
- `install.test.ts` - Test CLI installation logic
- `released-package.test.ts` - Smoke test for published npm package (run with `npm run test:released`)
